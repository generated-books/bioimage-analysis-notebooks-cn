
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.18.1: http://docutils.sourceforge.net/" />

    <title>根据信号强度区分细胞核 &#8212; Bio-image Analysis Notebooks</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/bootstrap.css?digest=796348d33e8b1d947c94" rel="stylesheet">
<link href="../_static/styles/pydata-sphinx-theme.css?digest=796348d33e8b1d947c94" rel="stylesheet">

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=796348d33e8b1d947c94" rel="stylesheet">
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2">
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2">

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=4ec06e9971c5264fbd345897d5258098f11cc577" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94">
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=8bf782fb4ee92b3d3646425e50f299c4e1fd152d"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '28_colocalization/differentiate_nuclei_intensity';</script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="算法验证" href="../29_algorithm_validation/readme.html" />
    <link rel="prev" title="共定位" href="readme.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="docsearch:language" content="en">
  </head>
  
  
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="180" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>

  
  <input type="checkbox" class="sidebar-toggle" name="__primary" id="__primary">
  <label class="overlay overlay-primary" for="__primary"></label>

  
  <input type="checkbox" class="sidebar-toggle" name="__secondary" id="__secondary">
  <label class="overlay overlay-secondary" for="__secondary"></label>

  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
      
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
  </div>

  
  <nav class="bd-header navbar navbar-expand-lg bd-navbar" id="navbar-main"><div class="bd-header__inner bd-page-width">
  <label class="sidebar-toggle primary-toggle" for="__primary">
      <span class="fa-solid fa-bars"></span>
  </label>
  <div id="navbar-start">
    
    
  


<a class="navbar-brand logo" href="../intro.html">

  
  
  
  
  
  
  

  
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    
  </div>

  
  <div class="col-lg-9 navbar-header-items">
    <div id="navbar-center" class="mr-auto">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../01_introduction/trailer.html">
                        预告片：使用Python进行生物图像分析
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../01_introduction/readme.html">
                        设置你的计算机
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../02_python_basics/readme.html">
                        Python 基础
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../04_sustainable_code/readme.html">
                        编写可持续的代码
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../12_image_analysis_basics/readme.html">
                        图像分析基础
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../12a_image_file_formats/readme.html">
                        图像文件格式
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../12b_remote_files/readme.html">
                        远程文件
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../14_machine_learning_basics/readme.html">
                        机器学习基础
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../16_3d_image_visualization/readme.html">
                        3D图像可视化
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../18_image_filtering/readme.html">
                        图像滤波
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../18a_deconvolution/readme.html">
                        图像反卷积
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../19_spatial_transforms/readme.html">
                        空间变换
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../20_image_segmentation/readme.html">
                        图像分割
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../20a_pixel_classification/readme.html">
                        机器学习用于图像分割
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../20b_deep_learning/readme.html">
                        基于深度学习的图像分割
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../20h_segmentation_post_processing/readme.html">
                        分割后处理
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../23_blob_detection/readme.html">
                        斑点检测
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../21_surface_processing/readme.html">
                        表面处理
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../22_feature_extraction/readme.html">
                        特征提取
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../25_neighborhood_relationships_between_cells/readme.html">
                        组织中的邻域分析
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../27_cell_classification/readme.html">
                        细胞分类
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="readme.html">
                        共定位
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../29_algorithm_validation/readme.html">
                        算法验证
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../30_simulating_data/readme.html">
                        模拟数据
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../03_advanced_python/readme.html">
                        高级 Python 编程
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../15_gpu_acceleration/readme.html">
                        GPU加速图像处理
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../31_graphical_user_interfaces/readme.html">
                        图形用户界面
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../32_tiled_image_processing/readme.html">
                        图像分块处理
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../01_introduction/glossary.html">
                        术语表
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../imprint.html">
                        版本说明
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
    </div>

    <div id="navbar-end">
      
        <div class="navbar-end-item navbar-persistent--container">
          
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
        </div>
      
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
  </div>


  
  
    <div class="navbar-persistent--mobile">
<button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-toggle="tooltip">
  <i class="fa-solid fa-magnifying-glass"></i>
</button>
    </div>
  

  
  <label class="sidebar-toggle secondary-toggle" for="__secondary">
      <span class="fa-solid fa-outdent"></span>
  </label>
  

</div>
  </nav>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        
  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
      <div class="sidebar-header-items__center">
      
      <div class="navbar-center-item">
        <nav class="navbar-nav">
    <p class="sidebar-header-items__title" role="heading" aria-level="1" aria-label="Site Navigation">
        Site Navigation
    </p>
    <ul id="navbar-main-elements" class="navbar-nav">
        
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../01_introduction/trailer.html">
                        预告片：使用Python进行生物图像分析
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../01_introduction/readme.html">
                        设置你的计算机
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../02_python_basics/readme.html">
                        Python 基础
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../04_sustainable_code/readme.html">
                        编写可持续的代码
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../12_image_analysis_basics/readme.html">
                        图像分析基础
                      </a>
                    </li>
                
            <div class="nav-item dropdown">
                <button class="btn dropdown-toggle nav-item" type="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    More
                </button>
                <div class="dropdown-menu">
                    
                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../12a_image_file_formats/readme.html">
                        图像文件格式
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../12b_remote_files/readme.html">
                        远程文件
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../14_machine_learning_basics/readme.html">
                        机器学习基础
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../16_3d_image_visualization/readme.html">
                        3D图像可视化
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../18_image_filtering/readme.html">
                        图像滤波
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../18a_deconvolution/readme.html">
                        图像反卷积
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../19_spatial_transforms/readme.html">
                        空间变换
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../20_image_segmentation/readme.html">
                        图像分割
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../20a_pixel_classification/readme.html">
                        机器学习用于图像分割
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../20b_deep_learning/readme.html">
                        基于深度学习的图像分割
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../20h_segmentation_post_processing/readme.html">
                        分割后处理
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../23_blob_detection/readme.html">
                        斑点检测
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../21_surface_processing/readme.html">
                        表面处理
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../22_feature_extraction/readme.html">
                        特征提取
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../25_neighborhood_relationships_between_cells/readme.html">
                        组织中的邻域分析
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../27_cell_classification/readme.html">
                        细胞分类
                      </a>
                    </li>
                

                    <li class="nav-item current active">
                      <a class="nav-link nav-internal" href="readme.html">
                        共定位
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../29_algorithm_validation/readme.html">
                        算法验证
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../30_simulating_data/readme.html">
                        模拟数据
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../03_advanced_python/readme.html">
                        高级 Python 编程
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../15_gpu_acceleration/readme.html">
                        GPU加速图像处理
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../31_graphical_user_interfaces/readme.html">
                        图形用户界面
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../32_tiled_image_processing/readme.html">
                        图像分块处理
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../01_introduction/glossary.html">
                        术语表
                      </a>
                    </li>
                

                    <li class="nav-item">
                      <a class="nav-link nav-internal" href="../imprint.html">
                        版本说明
                      </a>
                    </li>
                
                </div>
            </div>
            
    </ul>
</nav>
      </div>
      
      </div>
    

    
    
    <div class="sidebar-header-items__end">
      
      <div class="navbar-end-item">
        <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
</button>
      </div>
      
      <div class="navbar-end-item">
        <ul id="navbar-icon-links" class="navbar-nav" aria-label="Icon Links">
      </ul>
      </div>
      
    </div>
    
  </div>

  
  <div class="sidebar-start-items sidebar-primary__section">
    <div class="sidebar-start-items__item">
  


<a class="navbar-brand logo" href="../intro.html">

  
  
  
  
  
  
  

  
    <img src="../_static/logo.png" class="logo__image only-light" alt="Logo image">
    <img src="../_static/logo.png" class="logo__image only-dark" alt="Logo image">
  
  
</a>
    </div>
    <div class="sidebar-start-items__item">
<form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false">
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form>
    </div>
    <div class="sidebar-start-items__item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../intro.html">
                    生物图像分析笔记本
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01_introduction/trailer.html">预告片：使用Python进行生物图像分析</a></li>
<li class="toctree-l1"><a class="reference internal" href="../01_introduction/readme.html">设置你的计算机</a></li>

<li class="toctree-l1 has-children"><a class="reference internal" href="../02_python_basics/readme.html">Python 基础</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../02_python_basics/01_our_first_juptyer_notebook.html">Jupyter笔记本中的Python代码</a></li>

<li class="toctree-l2"><a class="reference internal" href="../02_python_basics/02_Math_in_python.html">Python中的基础数学运算</a></li>


<li class="toctree-l2"><a class="reference internal" href="../02_python_basics/03_Dont_try_this_at_home.html">使用Jupyter笔记本时的陷阱</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_python_basics/05_lists_tuples.html">列表和元组</a></li>




<li class="toctree-l2"><a class="reference internal" href="../02_python_basics/05a_cropping_lists.html">裁剪列表</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_python_basics/05b_sorting_lists.html">排序列表</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_python_basics/06_Dictionaries_and_tables.html">字典</a></li>


<li class="toctree-l2"><a class="reference internal" href="../02_python_basics/09_custom_functions.html">函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../02_python_basics/10_Import_packages.html">导入函数和包</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../04_sustainable_code/readme.html">编写可持续的代码</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../04_sustainable_code/readable_code.html">编写优质代码</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_sustainable_code/magic_numbers.html">避免魔法数字</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_sustainable_code/divide_and_rule.html">分而治之</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_sustainable_code/dont_repeat_yourself.html">不要重复自己</a></li>
<li class="toctree-l2"><a class="reference internal" href="../04_sustainable_code/keep_it_short_and_simple.html">保持简短和简单</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../12_image_analysis_basics/readme.html">图像分析基础</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../12_image_analysis_basics/01_Images_as_arrays.html">图像是数字数组</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12_image_analysis_basics/brightness_and_contrast.html">亮度和对比度</a></li>

<li class="toctree-l2"><a class="reference internal" href="../12_image_analysis_basics/03_Computing_with_images.html">图像计算</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12_image_analysis_basics/04_Cropping_images.html">裁剪图像</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12_image_analysis_basics/05_Masking_images.html">索引numpy数组</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12_image_analysis_basics/06_multi_channel_image_data.html">多通道图像数据</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../12a_image_file_formats/readme.html">图像文件格式</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../12a_image_file_formats/opening_images.html">打开图像数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12a_image_file_formats/opening_images_using_aicsimageio.html">使用AICSImageIO读取文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12a_image_file_formats/opening_czi_files.html">打开CZI文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12a_image_file_formats/opening_lif_files.html">打开LIF文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12a_image_file_formats/opening_tif_folders.html">加载多通道/多位置的tif文件夹</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12a_image_file_formats/tiled_image_file_formats_zarr.html">平铺图像文件格式：zarr</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12a_image_file_formats/image_file_formats.html">图像文件格式的优缺点</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../12b_remote_files/readme.html">远程文件</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../12b_remote_files/nextcloud.html">访问nextcloud中的图像文件</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12b_remote_files/exploring_idr.html">探索图像数据资源</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12b_remote_files/exploring_zenodo.html">访问Zenodo上的元数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../12b_remote_files/exploring_doi.html">从DOI.org读取元数据</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../14_machine_learning_basics/readme.html">机器学习基础</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../14_machine_learning_basics/supervised_machine_learning.html">监督式机器学习</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14_machine_learning_basics/unsupervised_machine_learning.html">无监督机器学习</a></li>
<li class="toctree-l2"><a class="reference internal" href="../14_machine_learning_basics/scaling.html">缩放</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../16_3d_image_visualization/readme.html">3D图像可视化</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../16_3d_image_visualization/10_nd_image_data.html">多维图像堆栈</a></li>
<li class="toctree-l2"><a class="reference internal" href="../16_3d_image_visualization/inspecting_3d_images.html">使用pyclesperanto检查3D图像数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../16_3d_image_visualization/napari.html">使用napari进行交互式图像可视化</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../18_image_filtering/readme.html">图像滤波</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../18_image_filtering/image_filtering.html">图像处理滤波器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../18_image_filtering/filter_overview.html">滤波概览</a></li>
<li class="toctree-l2"><a class="reference internal" href="../18_image_filtering/convolution.html">卷积</a></li>
<li class="toctree-l2"><a class="reference internal" href="../18_image_filtering/02_noise_removal.html">降噪滤波器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../18_image_filtering/03_background_removal.html">背景去除滤波器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../18_image_filtering/divide_by_gaussian.html">高斯除法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../18_image_filtering/edge_detection_and_enhancement.html">边缘检测</a></li>

<li class="toctree-l2"><a class="reference internal" href="../18_image_filtering/simpleitk.html">使用SimpleITK处理图像</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../18a_deconvolution/readme.html">图像反卷积</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../18a_deconvolution/introduction_deconvolution.html">图像反卷积简介</a></li>

<li class="toctree-l2"><a class="reference internal" href="../18a_deconvolution/extract_psf.html">通过平均法从珠子图像中确定点扩散函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../18a_deconvolution/richardson_lucy_deconvolution.html">OpenCL兼容GPU上的Richardson-Lucy反卷积</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../19_spatial_transforms/readme.html">空间变换</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../19_spatial_transforms/scaling.html">缩放</a></li>
<li class="toctree-l2"><a class="reference internal" href="../19_spatial_transforms/affine_transforms_scikit_image.html">使用scikit-image进行仿射变换</a></li>
<li class="toctree-l2"><a class="reference internal" href="../19_spatial_transforms/affine_transforms_scipy.html">使用Scipy进行仿射变换</a></li>
<li class="toctree-l2"><a class="reference internal" href="../19_spatial_transforms/affine_transforms_cupy.html">使用cupy进行仿射变换</a></li>
<li class="toctree-l2"><a class="reference internal" href="../19_spatial_transforms/affine_transforms_clesperanto.html">使用clesperanto进行仿射变换</a></li>


<li class="toctree-l2"><a class="reference internal" href="../19_spatial_transforms/scaling_coordinate_lists.html">缩放坐标列表</a></li>
<li class="toctree-l2"><a class="reference internal" href="../19_spatial_transforms/stitching_linear_blending.html">图像拼接</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Image Segmentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../20_image_segmentation/readme.html">图像分割</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../20_image_segmentation/terminology.html">术语</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20_image_segmentation/binarization.html">图像二值化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20_image_segmentation/08a_split_touching_objects.html">分离接触的对象</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20_image_segmentation/09a_gauss_otsu_labeling.html">高斯-大津-标记</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20_image_segmentation/10_touching_objects_labeling.html">接触物体标记</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20_image_segmentation/11_voronoi_otsu_labeling.html">Voronoi-Otsu标记</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20_image_segmentation/voronoi_otsu_labeling_for_binary_images.html">二值图像上的Voronoi-Otsu标记</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20_image_segmentation/11a_eroded_otsu_labeling.html">侵蚀Otsu标记</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20_image_segmentation/segmentation_2d_membranes.html">基于膜的细胞分割的种子分水岭方法</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20_image_segmentation/prevent_leaking_labels.html">防止标签泄漏</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20_image_segmentation/Segmentation_3D.html">3D图像分割</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../20a_pixel_classification/readme.html">机器学习用于图像分割</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../20a_pixel_classification/scikit_learn_random_forest_pixel_classifier.html">使用Scikit-learn进行像素分类</a></li>

<li class="toctree-l2"><a class="reference internal" href="../20a_pixel_classification/apoc_object_segmenter.html">在OpenCL兼容的GPU上进行对象分割</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20a_pixel_classification/apoc_pixel_classifier.html">在支持OpenCL的GPU上进行像素分类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20a_pixel_classification/interactive_pixel_classification/readme.html">在Napari中进行交互式像素分类和对象分割</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20a_pixel_classification/multichannel_images.html">多通道图像中的像素分类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20a_pixel_classification/apoc_probability_mapper.html">概率图</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20a_pixel_classification/apoc_train_on_folders.html">从图像文件夹训练像素分类器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20a_pixel_classification/feature_stacks.html">生成特征堆栈</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20a_pixel_classification/selecting_features.html">选择特征</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../20b_deep_learning/readme.html">基于深度学习的图像分割</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul class="simple">
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../20h_segmentation_post_processing/readme.html">分割后处理</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/morphological_operations.html">使用形态学操作对二值图像进行后处理</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/open_close_labels.html">标签图像优化</a></li>




<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/smooth_labels.html">平滑标签</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/splitting_touching_objects.html">分离接触对象</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/mode_filter.html">用于修正语义分割结果的众数滤波器</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/merge_labels.html">合并标签</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/merge_annotated_labels.html">合并注释标签</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/merging_labels_based_on_centroid_distance.html">根据质心距离合并标签</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/merging_labels_based_on_edge_to_edge_distance.html">根据边缘到边缘距离合并标签</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/merge_objects_using_machine_learning.html">使用机器学习合并对象</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/remove_labels_on_image_edges.html">移除图像边缘的标签</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/select_labels_based_on_size.html">根据大小选择标签</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/select_labels.html">使用机器学习选择标签</a></li>

<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/identify_labels_touching_background.html">识别接触背景的标签</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/erode_connected_labels.html">修改组织边界</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/sequential_labeling.html">顺序对象（重新）标记</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/label_edges.html">标签边缘</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/inner_and_outer_cell_borders.html">内部和外部细胞边界</a></li>
<li class="toctree-l2"><a class="reference internal" href="../20h_segmentation_post_processing/refine_cell_segmentation.html">基于膜的细胞分割后处理</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../23_blob_detection/readme.html">斑点检测</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../23_blob_detection/local_maxima_detection.html">局部极大值检测</a></li>
<li class="toctree-l2"><a class="reference internal" href="../23_blob_detection/blog_dog_log_doh.html">斑点检测</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../21_surface_processing/readme.html">表面处理</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../21_surface_processing/creating_surfaces.html">创建表面</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21_surface_processing/visualizing_surfaces.html">可视化表面</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21_surface_processing/saving_and_loading_surfaces.html">保存和加载表面</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21_surface_processing/smoothing_and_simplifying_surfaces.html">平滑和简化表面</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21_surface_processing/connected_component_labeling.html">表面上的连通组件标记</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21_surface_processing/surfaces_and_point_clouds.html">转换点和表面</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21_surface_processing/surfaces_to_images.html">从表面数据到图像数据</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21_surface_processing/tabular_quality_measurements.html">表面测量</a></li>
<li class="toctree-l2"><a class="reference internal" href="../21_surface_processing/quality_measurements.html">使用vedo在napari中进行表面质量测量</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Quantitative analysis</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../22_feature_extraction/readme.html">特征提取</a><input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../22_feature_extraction/quantitative_measurements.html">定量图像分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="../22_feature_extraction/count_blobs.html">计数图像中的亮对象</a></li>
<li class="toctree-l2"><a class="reference internal" href="../22_feature_extraction/statistics_with_pyclesperanto.html">使用pyclesperanto进行基础统计</a></li>
<li class="toctree-l2"><a class="reference internal" href="../22_feature_extraction/statistics_with_scikit_image.html">使用Scikit-image进行统计分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="../22_feature_extraction/statistics_with_nyxus.html">使用Nyxus进行统计</a></li>
<li class="toctree-l2"><a class="reference internal" href="../22_feature_extraction/comparison_of_measurements_from_different_libraries.html">比较不同库的测量结果</a></li>

<li class="toctree-l2"><a class="reference internal" href="../22_feature_extraction/measure_intensity_on_label_edges.html">测量标签边界的强度</a></li>
<li class="toctree-l2"><a class="reference internal" href="../22_feature_extraction/intensities_along_lines.html">图像中[多条]线的描述性统计</a></li>
<li class="toctree-l2"><a class="reference internal" href="../22_feature_extraction/shape_descriptors_based_on_neighborhood_graphs.html">基于邻域图的形状描述符</a></li>

<li class="toctree-l2"><a class="reference internal" href="../22_feature_extraction/distance_features.html">测量对象之间的距离</a></li>
<li class="toctree-l2"><a class="reference internal" href="../22_feature_extraction/distance_from_center.html">测量到中心线的距离</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../25_neighborhood_relationships_between_cells/readme.html">组织中的邻域分析</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../25_neighborhood_relationships_between_cells/05_count_touching_neighbors.html">计数接触邻居</a></li>


<li class="toctree-l2"><a class="reference internal" href="../25_neighborhood_relationships_between_cells/regional_properties.html">标签的区域属性</a></li>
<li class="toctree-l2"><a class="reference internal" href="../25_neighborhood_relationships_between_cells/06_mesh_with_distances.html">绘制邻居间的距离网格</a></li>
<li class="toctree-l2"><a class="reference internal" href="../25_neighborhood_relationships_between_cells/distance_to_other_labels.html">测量到另一个标签图像中细胞的距离</a></li>
<li class="toctree-l2"><a class="reference internal" href="../25_neighborhood_relationships_between_cells/other_proximal_labels_count.html">计算其他标签图像中的近邻标签数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../25_neighborhood_relationships_between_cells/neighbor_meshes_in_3d.html">三维邻居网格</a></li>
<li class="toctree-l2"><a class="reference internal" href="../25_neighborhood_relationships_between_cells/label_neighbor_filters.html">标记邻居过滤器</a></li>




</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../27_cell_classification/readme.html">细胞分类</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../27_cell_classification/apoc_object_classifier.html">在OpenCL兼容GPU上进行对象分类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../27_cell_classification/interactive_object_classification/readme.html">Napari中的交互式对象分类</a></li>
<li class="toctree-l2"><a class="reference internal" href="../27_cell_classification/forest_statistics.html">随机森林决策统计</a></li>
<li class="toctree-l2"><a class="reference internal" href="../27_cell_classification/apoc_simpleitk_object_classification.html">使用APOC和基于SimpleITK的特征进行对象分类</a></li>
</ul>
</li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="readme.html">共定位</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active"><a class="current reference internal" href="#">根据信号强度区分细胞核</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../29_algorithm_validation/readme.html">算法验证</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../29_algorithm_validation/segmentation_quality_estimation.html">图像分割质量测量</a></li>
<li class="toctree-l2"><a class="reference internal" href="../29_algorithm_validation/scenario_otsu_segmentation.html">场景:比较同一阈值算法的不同实现</a></li>
<li class="toctree-l2"><a class="reference internal" href="../29_algorithm_validation/visual_comparison.html">可视化标记比较</a></li>
<li class="toctree-l2"><a class="reference internal" href="../29_algorithm_validation/jaccard_index_versus_accuracy.html">Jaccard指数与准确率的比较</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../30_simulating_data/readme.html">模拟数据</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../30_simulating_data/basic_simulation_noise_background_nuclei.html">图像形成和图像恢复的模拟</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Advanced techniques</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../03_advanced_python/readme.html">高级 Python 编程</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../03_advanced_python/custom_libraries.html">自定义库</a></li>

<li class="toctree-l2"><a class="reference internal" href="../03_advanced_python/functional_parameters.html">函数式参数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_advanced_python/partial.html">偏函数</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_advanced_python/parallelization.html">并行化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../03_advanced_python/numba.html">使用numba进行并行化</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../15_gpu_acceleration/readme.html">GPU加速图像处理</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../15_gpu_acceleration/clesperanto.html">clEsperanto</a></li>
<li class="toctree-l2"><a class="reference internal" href="../15_gpu_acceleration/why_GPU_acceleration.html">为什么GPU加速是有意义的</a></li>
<li class="toctree-l2"><a class="reference internal" href="../15_gpu_acceleration/memory_management.html">追踪内存消耗</a></li>
<li class="toctree-l2"><a class="reference internal" href="../15_gpu_acceleration/further_reading.html">进一步阅读</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../31_graphical_user_interfaces/readme.html">图形用户界面</a><input class="toctree-checkbox" id="toctree-checkbox-25" name="toctree-checkbox-25" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-25"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../31_graphical_user_interfaces/napari.html">使用napari进行交互式图像可视化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../31_graphical_user_interfaces/napari_magicgui.html">使用napari和magicgui进行交互式参数调整</a></li>
<li class="toctree-l2"><a class="reference internal" href="../31_graphical_user_interfaces/napari-skimage-regionprops.html">在napari中可视化区域属性</a></li>
<li class="toctree-l2"><a class="reference internal" href="../31_graphical_user_interfaces/napari_dask.html">Napari中的粉虱胚胎形态测量随时间变化</a></li>
<li class="toctree-l2"><a class="reference internal" href="../31_graphical_user_interfaces/napari_crop.html">使用napari进行交互式裁剪</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../32_tiled_image_processing/readme.html">图像分块处理</a><input class="toctree-checkbox" id="toctree-checkbox-26" name="toctree-checkbox-26" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-26"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../32_tiled_image_processing/tiled_nuclei_counting_quick.html">分块图像处理,快速概览</a></li>
<li class="toctree-l2"><a class="reference internal" href="../32_tiled_image_processing/tiled_connected_component_labeling.html">瓦片中的连通分量标记</a></li>
<li class="toctree-l2"><a class="reference internal" href="../32_tiled_image_processing/tiled_area_mapping.html">在图块中映射对象面积</a></li>
<li class="toctree-l2"><a class="reference internal" href="../32_tiled_image_processing/tiled_nuclei_counting.html">计算瓦片中的细胞核数量</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Appendix</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../01_introduction/glossary.html">术语表</a></li>
<li class="toctree-l1"><a class="reference internal" href="../imprint.html">版本说明</a></li>

</ul>

    </div>
</nav>
    </div>
  </div>
  

  
  <div class="sidebar-end-items sidebar-primary__section">
    <div class="sidebar-end-items__item">
    </div>
  </div>

  
  <div id="rtd-footer-container"></div>

      </div>
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

        <div class="bd-content">
          <div class="bd-article-container">
            
            <div class="bd-header-article">
                



<div class="col py-1 d-flex header-article-main">
    <div class="header-article__left">
        <label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" data-toggle="tooltip" data-placement="right" title="Toggle primary sidebar">
            <span class="fa-solid fa-bars"></span>
        </label>
    </div>
    <div class="header-article__right">


<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
  </ul>
</div>

<button onclick="toggleFullScreen()"
  class="btn btn-sm"
  data-toggle="tooltip"
data-placement="bottom"
title="Fullscreen mode"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<div class="dropdown dropdown-repository-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      <li><a href="https://github.com/haesleinhuepf/BioImageAnalysisNotebooks" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Source repository"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">repository</span>
</a>
</a>
      
      <li><a href="https://github.com/haesleinhuepf/BioImageAnalysisNotebooks/issues/new?title=Issue%20on%20page%20%2F28_colocalization/differentiate_nuclei_intensity.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Open an issue"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">open issue</span>
</a>
</a>
      
  </ul>
</div>



<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      <li><a href="../_sources/28_colocalization/differentiate_nuclei_intensity.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   data-toggle="tooltip"
data-placement="left"
title="Download source file"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</a>
      
      <li>
<button onclick="printPdf(this)"
  class="btn btn-sm dropdown-item"
  data-toggle="tooltip"
data-placement="left"
title="Print to PDF"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</a>
      
  </ul>
</div>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary" data-toggle="tooltip" data-placement="left" title="Toggle secondary sidebar">
            <span class="fa-solid fa-list"></span>
        </label>
    </div>
</div>
            </div>
            
            

<div id="jb-print-docs-body" class="onlyprint">
    <h1>根据信号强度区分细胞核</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   细胞核分割
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   选择高于给定强度阈值的标签
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   参考资料
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>

            <article class="bd-article" role="main">
              
  <section class="tex2jax_ignore mathjax_ignore" id="id1">
<h1>根据信号强度区分细胞核<a class="headerlink" href="#id1" title="Permalink to this heading">#</a></h1>
<p>一个常见的生物图像分析任务是根据细胞的信号表达来区分细胞。在这个例子中，我们使用一张表达Cy3和eGFP的细胞核的双通道图像。从视觉上，我们可以很容易地看出一些表达Cy3的细胞核也表达eGFP，而其他的则没有。这个笔记本演示了如何区分在一个通道中分割的细胞核，根据它们在另一个通道中的强度。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pyclesperanto_prototype</span> <span class="k">as</span> <span class="nn">cle</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">skimage.io</span> <span class="kn">import</span> <span class="n">imread</span><span class="p">,</span> <span class="n">imshow</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">cle</span><span class="o">.</span><span class="n">get_device</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;Intel(R) Iris(R) Xe Graphics on Platform: Intel(R) OpenCL HD Graphics (1 refs)&gt;
</pre></div>
</div>
</div>
</div>
<p>我们使用的数据集由<a class="reference external" href="https://doi.org/10.1091/mbc.E13-04-0221">Heriche et al.</a>发布，根据<a class="reference external" href="https://creativecommons.org/licenses/by/4.0/">CC BY 4.0</a>许可，可在<a class="reference external" href="https://idr.openmicroscopy.org/webclient/img_detail/179719/">Image Data Resource</a>获取。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># load file</span>
<span class="n">raw_image</span> <span class="o">=</span> <span class="n">imread</span><span class="p">(</span><span class="s1">&#39;../../data/plate1_1_013 [Well 5, Field 1 (Spot 5)].png&#39;</span><span class="p">)</span>

<span class="c1"># visualize</span>
<span class="n">imshow</span><span class="p">(</span><span class="n">raw_image</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1dac72d7c40&gt;
</pre></div>
</div>
<img alt="../_images/55866c743e5f1b019fe279c32b8b45bd7c4b04fbb1a2e48e20784eddae284f08.png" src="../_images/55866c743e5f1b019fe279c32b8b45bd7c4b04fbb1a2e48e20784eddae284f08.png" />
</div>
</div>
<p>首先，我们需要分离通道（<a class="reference external" href="https://github.com/BiAPoL/Bio-image_Analysis_with_Python/blob/a62070dee408814cee4258758f5187f135774519/image_processing/03_multi_channel_image_data.ipynb">了解更多</a>）。之后，我们实际上可以看到，并非所有用Cy3标记的细胞（通道0）也被eGFP标记（通道1）：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># extract channels</span>
<span class="n">channel_cy3</span> <span class="o">=</span> <span class="n">raw_image</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">0</span><span class="p">]</span>
<span class="n">channel_egfp</span> <span class="o">=</span> <span class="n">raw_image</span><span class="p">[</span><span class="o">...</span><span class="p">,</span><span class="mi">1</span><span class="p">]</span>

<span class="c1"># visualize</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">channel_cy3</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
<span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">channel_egfp</span><span class="p">,</span> <span class="n">cmap</span><span class="o">=</span><span class="s1">&#39;gray&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;matplotlib.image.AxesImage at 0x1dac7328970&gt;
</pre></div>
</div>
<img alt="../_images/dfecfb0e63b53ca9374d31a134cb3adb95fdc907014d76f36a545970d9bf8d56.png" src="../_images/dfecfb0e63b53ca9374d31a134cb3adb95fdc907014d76f36a545970d9bf8d56.png" />
</div>
</div>
<section id="id2">
<h2>细胞核分割<a class="headerlink" href="#id2" title="Permalink to this heading">#</a></h2>
<p>由于染色在Cy3通道标记了细胞核，因此在这个通道中分割细胞核并随后测量另一个通道的强度是合理的。我们使用<a class="reference external" href="https://github.com/clEsperanto/pyclesperanto_prototype/blob/f9c9b73c1f9f194fdabdab8bd8507eb73c3ef8c9/demo/segmentation/voronoi_otsu_labeling.ipynb">Voronoi-Otsu-Labeling</a>进行分割，因为这是一种快速直接的方法。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># segmentation</span>
<span class="n">nuclei_cy3</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">voronoi_otsu_labeling</span><span class="p">(</span><span class="n">channel_cy3</span><span class="p">,</span> <span class="n">spot_sigma</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="c1"># visualize</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">channel_cy3</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">nuclei_cy3</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\rober\miniconda3\envs\bio39\lib\site-packages\pyclesperanto_prototype\_tier9\_imshow.py:46: UserWarning: The imshow parameter color_map is deprecated. Use colormap instead.
  warnings.warn(&quot;The imshow parameter color_map is deprecated. Use colormap instead.&quot;)
</pre></div>
</div>
<img alt="../_images/a906df9f94baa40d3504aff6fd8bd74bb1f6c160e0c6ed3861211756a9fa9a86.png" src="../_images/a906df9f94baa40d3504aff6fd8bd74bb1f6c160e0c6ed3861211756a9fa9a86.png" />
</div>
</div>
<p>首先，我们可以测量第二个通道（标记为eGFP）的强度，并在参数图像中可视化该测量结果。在这样的参数图像中，细胞核内的所有像素都具有相同的值，在这种情况下是细胞的平均强度。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intensity_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">mean_intensity_map</span><span class="p">(</span><span class="n">channel_egfp</span><span class="p">,</span> <span class="n">nuclei_cy3</span><span class="p">)</span>

<span class="c1"># visualize</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">channel_egfp</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">intensity_map</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\rober\miniconda3\envs\bio39\lib\site-packages\pyclesperanto_prototype\_tier9\_imshow.py:46: UserWarning: The imshow parameter color_map is deprecated. Use colormap instead.
  warnings.warn(&quot;The imshow parameter color_map is deprecated. Use colormap instead.&quot;)
</pre></div>
</div>
<img alt="../_images/f5d1571acbbba97334a87fe3d6eec2664d76edff89a9a86aed73614f840c42a0.png" src="../_images/f5d1571acbbba97334a87fe3d6eec2664d76edff89a9a86aed73614f840c42a0.png" />
</div>
</div>
<p>从这样的参数图像中，我们可以提取强度值并将它们放入一个向量中。这个列表中的第一项值为0，对应于背景的强度，在参数图像中为0。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intensity_vector</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">read_intensities_from_map</span><span class="p">(</span><span class="n">nuclei_cy3</span><span class="p">,</span> <span class="n">intensity_map</span><span class="p">)</span>
<span class="n">intensity_vector</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><pre>cle.array([[  0.        80.875854  23.529799 118.17817   80.730255  95.55177
   72.84752   92.34759   78.84362   85.400444 105.108025  65.06639
   73.69295   77.40091   81.48371   77.12868   96.58209   95.94536
   70.883995  89.70502   72.01046   27.257877  84.460075  25.49711
   80.69057  147.49736   28.112642  25.167627  28.448263  25.31705
   38.072815 108.81613 ]], dtype=float32)</pre></div></div>
</div>
<p>顺便说一下，还有另一种直接获得平均强度的方法，即通过测量包括位置和形状在内的细胞核的所有属性。这些统计数据可以进一步作为<a class="reference external" href="https://pandas.pydata.org/">pandas</a> DataFrame处理。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">statistics</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">statistics_of_background_and_labelled_pixels</span><span class="p">(</span><span class="n">channel_egfp</span><span class="p">,</span> <span class="n">nuclei_cy3</span><span class="p">)</span>

<span class="n">statistics_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">statistics</span><span class="p">)</span>
<span class="n">statistics_df</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>label</th>
      <th>original_label</th>
      <th>bbox_min_x</th>
      <th>bbox_min_y</th>
      <th>bbox_min_z</th>
      <th>bbox_max_x</th>
      <th>bbox_max_y</th>
      <th>bbox_max_z</th>
      <th>bbox_width</th>
      <th>bbox_height</th>
      <th>...</th>
      <th>centroid_z</th>
      <th>sum_distance_to_centroid</th>
      <th>mean_distance_to_centroid</th>
      <th>sum_distance_to_mass_center</th>
      <th>mean_distance_to_mass_center</th>
      <th>standard_deviation_intensity</th>
      <th>max_distance_to_centroid</th>
      <th>max_distance_to_mass_center</th>
      <th>mean_max_distance_to_centroid_ratio</th>
      <th>mean_max_distance_to_mass_center_ratio</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>1</td>
      <td>0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>0.0</td>
      <td>1841.0</td>
      <td>1477.0</td>
      <td>0.0</td>
      <td>1842.0</td>
      <td>1478.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>1.683849e+09</td>
      <td>640.648682</td>
      <td>1.683884e+09</td>
      <td>640.661682</td>
      <td>8.487288</td>
      <td>1187.033203</td>
      <td>1187.743164</td>
      <td>1.852861</td>
      <td>1.853932</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2</td>
      <td>1</td>
      <td>127.0</td>
      <td>967.0</td>
      <td>0.0</td>
      <td>167.0</td>
      <td>1033.0</td>
      <td>0.0</td>
      <td>41.0</td>
      <td>67.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>4.128044e+04</td>
      <td>18.704323</td>
      <td>4.128327e+04</td>
      <td>18.705606</td>
      <td>4.734930</td>
      <td>34.280727</td>
      <td>34.338104</td>
      <td>1.832770</td>
      <td>1.835712</td>
    </tr>
    <tr>
      <th>2</th>
      <td>3</td>
      <td>2</td>
      <td>259.0</td>
      <td>205.0</td>
      <td>0.0</td>
      <td>314.0</td>
      <td>265.0</td>
      <td>0.0</td>
      <td>56.0</td>
      <td>61.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>5.392080e+04</td>
      <td>19.715099</td>
      <td>5.393993e+04</td>
      <td>19.722092</td>
      <td>1.663603</td>
      <td>32.079941</td>
      <td>31.469477</td>
      <td>1.627176</td>
      <td>1.595646</td>
    </tr>
    <tr>
      <th>3</th>
      <td>4</td>
      <td>3</td>
      <td>432.0</td>
      <td>1377.0</td>
      <td>0.0</td>
      <td>492.0</td>
      <td>1423.0</td>
      <td>0.0</td>
      <td>61.0</td>
      <td>47.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>3.630314e+04</td>
      <td>17.769527</td>
      <td>3.636823e+04</td>
      <td>17.801388</td>
      <td>24.842560</td>
      <td>36.856213</td>
      <td>36.085457</td>
      <td>2.074125</td>
      <td>2.027115</td>
    </tr>
    <tr>
      <th>4</th>
      <td>5</td>
      <td>4</td>
      <td>631.0</td>
      <td>1123.0</td>
      <td>0.0</td>
      <td>690.0</td>
      <td>1194.0</td>
      <td>0.0</td>
      <td>60.0</td>
      <td>72.0</td>
      <td>...</td>
      <td>0.0</td>
      <td>6.753254e+04</td>
      <td>21.686750</td>
      <td>6.755171e+04</td>
      <td>21.692907</td>
      <td>17.358543</td>
      <td>38.805695</td>
      <td>38.417568</td>
      <td>1.789373</td>
      <td>1.770974</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 37 columns</p>
</div></div></div>
</div>
<p>然后可以从表格统计数据中提取强度向量。注意：在这种情况下，背景强度不是0，因为我们直接从原始图像中读取它。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intensity_vector2</span> <span class="o">=</span> <span class="n">statistics</span><span class="p">[</span><span class="s1">&#39;mean_intensity&#39;</span><span class="p">]</span>
<span class="n">intensity_vector2</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>array([ 20.829758,  80.875854,  23.529799, 118.17817 ,  80.730255,
        95.55177 ,  72.84752 ,  92.34759 ,  78.84362 ,  85.400444,
       105.108025,  65.06639 ,  73.69295 ,  77.40091 ,  81.48371 ,
        77.12868 ,  96.58209 ,  95.94536 ,  70.883995,  89.70502 ,
        72.01046 ,  27.257877,  84.460075,  25.49711 ,  80.69057 ,
       147.49736 ,  28.112642,  25.167627,  28.448263,  25.31705 ,
        38.072815, 108.81613 ], dtype=float32)
</pre></div>
</div>
</div>
</div>
<p>为了概览平均强度测量，我们可以使用<a class="reference external" href="https://matplotlib.org/">matplotlib</a>绘制直方图。我们忽略第一个元素，因为它对应于背景强度。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">hist</span><span class="p">(</span><span class="n">intensity_vector2</span><span class="p">[</span><span class="mi">1</span><span class="p">:])</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(array([ 7.,  1.,  0.,  4., 10.,  5.,  2.,  1.,  0.,  1.]),
 array([ 23.52979851,  35.92655563,  48.32331085,  60.72006607,
         73.11682129,  85.51358032,  97.91033936, 110.30709076,
        122.70384979, 135.1006012 , 147.49736023]),
 &lt;BarContainer object of 10 artists&gt;)
</pre></div>
</div>
<img alt="../_images/9db27b022e25de959ff355f0cc671c60e20c497536b613ca9d9bec2632758a76.png" src="../_images/9db27b022e25de959ff355f0cc671c60e20c497536b613ca9d9bec2632758a76.png" />
</div>
</div>
<p>从这样的直方图中，我们可以得出结论，强度高于50的对象是阳性的。</p>
</section>
<section id="id3">
<h2>选择高于给定强度阈值的标签<a class="headerlink" href="#id3" title="Permalink to this heading">#</a></h2>
<p>接下来，我们生成一个新的标签图像，其中包含强度 &gt; 50的细胞核。注意，上述所有提取强度向量的步骤对此并不是必需的。我们这样做只是为了对一个好的强度阈值有一个概念。</p>
<p>以下标签图像显示了在Cy3通道中分割的细胞核，这些细胞核在eGFP通道中具有高强度。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">intensity_threshold</span> <span class="o">=</span> <span class="mi">50</span>

<span class="n">nuclei_with_high_intensity_egfg</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">exclude_labels_with_map_values_within_range</span><span class="p">(</span><span class="n">intensity_map</span><span class="p">,</span> <span class="n">nuclei_cy3</span><span class="p">,</span> <span class="n">maximum_value_range</span><span class="o">=</span><span class="n">intensity_threshold</span><span class="p">)</span>
<span class="n">intensity_map</span> <span class="o">=</span> <span class="n">cle</span><span class="o">.</span><span class="n">mean_intensity_map</span><span class="p">(</span><span class="n">channel_egfp</span><span class="p">,</span> <span class="n">nuclei_cy3</span><span class="p">)</span>

<span class="c1"># visualize</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">15</span><span class="p">,</span><span class="mi">15</span><span class="p">))</span>
<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">channel_egfp</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">color_map</span><span class="o">=</span><span class="s2">&quot;gray&quot;</span><span class="p">)</span>
<span class="n">cle</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">nuclei_with_high_intensity_egfg</span><span class="p">,</span> <span class="n">plot</span><span class="o">=</span><span class="n">axs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>C:\Users\rober\miniconda3\envs\bio39\lib\site-packages\pyclesperanto_prototype\_tier9\_imshow.py:46: UserWarning: The imshow parameter color_map is deprecated. Use colormap instead.
  warnings.warn(&quot;The imshow parameter color_map is deprecated. Use colormap instead.&quot;)
</pre></div>
</div>
<img alt="../_images/48e11aa7c0c5c19b40e9692923027602ef9e496f9b3b624a674cc280aa3d5cea.png" src="../_images/48e11aa7c0c5c19b40e9692923027602ef9e496f9b3b624a674cc280aa3d5cea.png" />
</div>
</div>
<p>我们还可以通过确定标签图像中的最大强度来计算这些细胞的数量：</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">number_of_double_positives</span> <span class="o">=</span> <span class="n">nuclei_with_high_intensity_egfg</span><span class="o">.</span><span class="n">max</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;同时表达Cy3和eGFP的细胞核数量&quot;</span><span class="p">,</span> <span class="n">number_of_double_positives</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Number of Cy3 nuclei that also express eGFP 23.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="id4">
<h2>参考资料<a class="headerlink" href="#id4" title="Permalink to this heading">#</a></h2>
<p>我们使用的一些函数可能不太常见。因此，我们可以添加它们的文档以供参考。</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cle</span><span class="o">.</span><span class="n">voronoi_otsu_labeling</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Labels objects directly from grey-value images.

    The two sigma parameters allow tuning the segmentation result. Under the hood,
    this filter applies two Gaussian blurs, spot detection, Otsu-thresholding [2] and Voronoi-labeling [3]. The
    thresholded binary image is flooded using the Voronoi tesselation approach starting from the found local maxima.

    Notes
    -----
    * This operation assumes input images are isotropic.

    Parameters
    ----------
    source : Image
        Input grey-value image
    label_image_destination : Image, optional
        Output image
    spot_sigma : float, optional
        controls how close detected cells can be
    outline_sigma : float, optional
        controls how precise segmented objects are outlined.
    
    Returns
    -------
    label_image_destination
    
    Examples
    --------
    &gt;&gt;&gt; import pyclesperanto_prototype as cle
    &gt;&gt;&gt; cle.voronoi_otsu_labeling(source, label_image_destination, 10, 2)
    
    References
    ----------
    .. [1] https://clij.github.io/clij2-docs/reference_voronoiOtsuLabeling
    .. [2] https://ieeexplore.ieee.org/document/4310076
    .. [3] https://en.wikipedia.org/wiki/Voronoi_diagram
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cle</span><span class="o">.</span><span class="n">mean_intensity_map</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Takes an image and a corresponding label map, determines the mean 
    intensity per label and replaces every label with the that number.
    
    This results in a parametric image expressing mean object intensity. 
    
    Parameters
    ----------
    source : Image
    label_map : Image
    destination : Image, optional
    
    Returns
    -------
    destination
    
    References
    ----------
    .. [1] https://clij.github.io/clij2-docs/reference_meanIntensityMap
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cle</span><span class="o">.</span><span class="n">read_intensities_from_map</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Takes a label image and a parametric image to read parametric values from the labels positions.
    The read intensity values are stored in a new vector.

    Note: This will only work if all labels have number of voxels == 1 or if all pixels in each label have the same value.

    Parameters
    ----------
    labels: Image
    map_image: Image
    values_destination: Image, optional
        1d vector with length == number of labels + 1

    Returns
    -------
    values_destination, Image:
        vector of intensity values with 0th element corresponding to background and subsequent entries corresponding to
        the intensity in the given labeled object
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cle</span><span class="o">.</span><span class="n">statistics_of_background_and_labelled_pixels</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Determines bounding box, area (in pixels/voxels), min, max and mean 
    intensity of background and labelled objects in a label map and corresponding
    pixels in the original image.
    
    Instead of a label map, you can also use a binary image as a binary image is a 
    label map with just one label.
    
    This method is executed on the CPU and not on the GPU/OpenCL device. 
    
    Parameters
    ----------
    source : Image
    labelmap : Image

    Returns
    -------
    Dictionary of measurements
    
    References
    ----------
    .. [1] https://clij.github.io/clij2-docs/reference_statisticsOfBackgroundAndLabelledPixels
    
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">cle</span><span class="o">.</span><span class="n">exclude_labels_with_map_values_within_range</span><span class="o">.</span><span class="vm">__doc__</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>This operation removes labels from a labelmap and renumbers the
    remaining labels.

    Notes
    -----
    * Values of all pixels in a label each must be identical.

    Parameters
    ----------
    values_map : Image
    label_map_input : Image
    label_map_destination : Image, optional
    minimum_value_range : Number, optional
    maximum_value_range : Number, optional

    Returns
    -------
    label_map_destination

    References
    ----------
    .. [1] https://clij.github.io/clij2-docs/reference_excludeLabelsWithValuesWithinRange
    
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./28_colocalization"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

            </article>
            

            
            
            <footer class="bd-footer-article">
                <!-- Previous / next buttons -->
<div class='prev-next-area'>
  <a class='left-prev' id="prev-link" href="readme.html" title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
          <p class="prev-next-subtitle">previous</p>
          <p class="prev-next-title">共定位</p>
      </div>
  </a>
  <a class='right-next' id="next-link" href="../29_algorithm_validation/readme.html" title="next page">
  <div class="prev-next-info">
      <p class="prev-next-subtitle">next</p>
      <p class="prev-next-title">算法验证</p>
  </div>
  <i class="fa-solid fa-angle-right"></i>
  </a>
</div>
            </footer>
            
          </div>
          
          
          
            <div class="bd-sidebar-secondary bd-toc">
              
<div class="toc-item">
  
<div class="tocsection onthispage">
    <i class="fa-solid fa-list"></i> On this page
</div>
<nav id="bd-toc-nav" class="page-toc">
    <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id2">
   细胞核分割
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id3">
   选择高于给定强度阈值的标签
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#id4">
   参考资料
  </a>
 </li>
</ul>

</nav>
</div>

            </div>
          
          
        </div>
        <footer class="bd-footer-content">
          <div class="bd-footer-content__inner">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Robert Haase, Guillaume Witz, Miguel Fernandes, Marcelo Leomil Zoccoler, Shannon Taylor, Mara Lampert, Till Korten & add-your-name-here-by-sending-a-pull-request-containing-a-notebook
</p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    <p class="last-updated">
Last updated on None.<br>
</p>
  </div>
  
  <div class="footer-item">
    
<div class="extra_footer">
  <p>
Copyright: Licensed <a href="https://creativecommons.org/licenses/by/4.0/" target="_blank">CC-BY 4.0</a> and <a href="https://github.com/haesleinhuepf/BioImageAnalysisNotebooks/blob/main/LICENSE-BSD3" target="_blank">BSD3</a> unless mentioned otherwise. 
<a href="https://github.com/haesleinhuepf/BioImageAnalysisNotebooks/blob/main/CONTRIBUTING.md" target="_blank">Contribution and feedback welcome.</a>
</p>

</div>
  </div>
  
</div>
          </div>
        </footer>
        

      </main>
    </div>
  </div>

  
    
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=796348d33e8b1d947c94"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=796348d33e8b1d947c94"></script>

  </body>
</html>